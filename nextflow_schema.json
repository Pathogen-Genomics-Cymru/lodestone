{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://raw.githubusercontent.com//master/nextflow_schema.json",
    "title": " pipeline parameters",
    "description": "",
    "type": "object",
    "properties": {
        "input_dir": {
            "type": "string"
        },
        "filetype": {
            "type": "string",
            "default": "fastq"
        },
        "pattern": {
            "type": "string"
        },
        "output_dir": {
            "type": "string"
        },
        "unmix_myco": {
            "type": "string",
            "default": "no"
        },
        "species": {
            "type": "string"
        },
        "kraken_db": {
            "type": "string",
            "default": "kraken2"
        },
        "bowtie2_index": {
            "type": "string",
            "default": "bowtie2"
        },
        "bowtie_index_name": {
            "type": "string",
            "default": "hg19_1kgmaj"
        },
        "resistance_profiler": {
            "type": "string",
            "default": "tb-profiler"
        },
        "update_tbprofiler": {
            "type": "string",
            "default": "no"
        },
        "collate": {
            "type": "string",
            "default": "yes"
        },
        "sing_dir": {
            "type": "string",
            "default": "/home/ubuntu/magma/lodestone/singularity"
        },
        "config_dir": {
            "type": "string",
            "default": "/home/ubuntu/magma/lodestone/nextflow.config"
        },
        "afanc_myco_db": {
            "type": "string",
            "default": "/home/ubuntu/magma/lodestone/Mycobacteriaciae_DB_7.0/"
        },
        "resource_dir": {
            "type": "string",
            "default": "/home/ubuntu/magma/lodestone/resources"
        },
        "refseq": {
            "type": "string",
            "default": "/home/ubuntu/magma/lodestone/resources/assembly_summary_refseq.txt"
        },
        "permissive": {
            "type": "string",
            "default": "no"
        }
    },
    "required": [
        "input_dir",
        "pattern",
        "output_dir"
    ],
    "$defs": {
        "kraken": {
            "title": "kraken",
            "type": "object",
            "description": "Kraken thresholds",
            "default": "",
            "properties": {
                "kraken_n_reads_threshold": {
                    "type": "integer",
                    "description": "Total reads threshold of total reads in Kraken report needed to keep when filtering",
                    "default": 10000
                },
                "kraken_percent_threshold": {
                    "type": "number",
                    "description": "Percentage threshold of total reads in Kraken report needed to keep when filtering",
                    "default": 10
                }
            }
        },
        "afanc": {
            "title": "afanc",
            "type": "object",
            "description": "Afanc thresholds",
            "default": "",
            "properties": {
                "afanc_percent_threshold": {
                    "type": "number",
                    "description": "Threshold percentage for Afanc. Percentage of reads needing to be mapped to a species in order to be considered",
                    "default": 10,
                    "minimum": 0,
                    "maximum": 100
                },
                "afanc_n_reads_threshold": {
                    "type": "integer",
                    "description": "Total number of reads for Afanc. Number of reads needing to be mapped to a species in order to be considered",
                    "default": 10000
                },
                "afanc_fail_percent_threshold": {
                    "type": "number",
                    "description": "Same as percent_threshold but lowered if Lodestone fails before Afanc",
                    "default": 2
                },
                "afanc_fail_n_reads_threshold": {
                    "type": "integer",
                    "description": "Same as n_reads_thresholdbut lowered if Lodestone fails before Afanc",
                    "default": 500
                }
            }
        }
    },
    "allOf": [
        {
            "$ref": "#/$defs/kraken"
        },
        {
            "$ref": "#/$defs/afanc"
        }
    ]
}
